 
<template>
  <!-- 消息提示 -->
  <div class="login">
    <!-- 登录框 -->
    <!-- 登录版心 277.91px -->
    <div class="el-col el-col-10 translate-left">
      <!-- 登录框分为三部分 1.logo,2.表单,3底部 记住我和忘记密码 -->
      <div class="loginwarper">
        <div class="logo">
          <svg
            data-v-472add70
            version="1.1"
            role="presentation"
            width="73.14285714285714"
            height="73.14285714285714"
            viewBox="0 0 1024 1024"
            class="svg-icon active"
            style="font-size: 8em;"
          >
            <path
              d="M815.564955 807.444109c-5.413897 8.507553-10.827795 17.78852-17.78852 24.749244-6.187311 5.413897-19.335347 0-15.468278-8.507552 4.640483-10.054381 10.054381-20.108761 15.468278-30.163142 4.640483-8.507553 8.507553-19.335347 17.78852-23.975831 6.960725-3.093656 17.015106 0.773414 16.241692 9.280967-1.546828 10.827795-10.054381 19.335347-16.241692 28.616314z m-44.084592 6.187311c-6.960725 8.507553-26.296073 35.577039-40.217523 30.163142-2.320242-0.773414-3.093656-2.320242-3.86707-4.640483-0.773414-6.960725 5.413897-11.601208 9.280967-16.241692l20.882175-25.522659c13.148036-17.78852 23.975831-35.577039 34.030212-54.912387 7.734139-14.694864 27.8429-1.546828 21.655589 12.374623-9.280967 21.655589-26.296073 41.76435-41.76435 58.779456z m-16.241692-48.725076c-19.335347 24.749245-36.350453 51.045317-58.006043 75.021148-5.413897 6.187311-15.468278-1.546828-11.601208-8.507552 14.694864-27.8429 34.803625-52.592145 52.592145-78.114804 10.827795-16.241692 23.202417-46.404834 40.990937-54.912387 6.187311-3.093656 16.241692 0.773414 14.694864 8.507553-1.546828 20.108761-26.296073 41.76435-38.670695 58.006042z m-118.332327 67.287009c-10.827795-6.960725 51.818731-78.114804 57.232629-86.622356 17.015106-23.202417 34.030211-47.178248 48.725075-71.927492 6.187311-10.827795 10.827795-30.163142 23.202417-34.803626 3.093656-0.773414 7.734139 0 10.054381 2.320242l0.773414 0.773414c3.093656 3.093656 4.640483 7.734139 3.093655 12.374622-9.280967 26.296073-119.10574 194.900302-143.081571 177.885196z m93.583082-197.220543c-16.241692 27.8429-34.030211 54.138973-50.271903 81.981873-26.296073 44.084592-53.365559 94.356495-94.356496 126.839879-4.640483 3.867069-13.92145-1.546828-9.280967-6.960725C633.812689 756.398792 674.803625 665.135952 731.26284 584.700906c8.507553-12.374622 27.8429-1.546828 22.429003 10.054381-3.867069 14.694864-15.468278 27.069486-23.202417 40.217523z m-187.939577 205.728096c-6.187311 7.734139-18.561934-2.320242-13.148036-10.05438 65.740181-97.450151 119.879154-201.087613 179.432024-301.63142 7.734139-13.148036 27.8429-1.546828 20.108761 11.601208-58.006042 101.317221-112.145015 208.048338-186.392749 300.084592z m-37.897281-2.320241c-4.640483 8.507553-17.015106 0.773414-13.148036-7.734139 55.685801-120.652568 120.652568-237.438066 194.900302-347.26284 8.507553-12.374622 29.389728-0.773414 20.882175 12.374622-71.927492 112.145015-136.89426 227.383686-202.634441 342.622357z m69.607251-193.353475c-41.76435 64.193353-83.528701 125.293051-114.465257 196.44713-3.867069 9.280967-17.78852 2.320242-15.468278-6.187311 20.108761-75.021148 66.513595-138.441088 106.731118-202.634441 41.76435-66.513595 68.833837-139.987915 108.277945-207.274924 8.507553-14.694864 30.936556-1.546828 22.429003 13.148036-37.123867 67.287009-64.193353 139.987915-107.504531 206.50151z m-35.57704-43.311178C497.691843 679.830816 455.154079 757.945619 413.389728 835.287009c-3.093656 6.187311-13.92145 2.320242-11.601208-4.640483 31.70997-92.036254 81.981873-177.111782 124.519637-263.734139 34.803625-71.154079 57.232628-152.362538 107.504532-214.23565 9.280967-10.827795 27.069486 3.093656 19.335347 14.694864-47.178248 72.700906-74.247734 157.003021-114.465257 234.344411z m-168.604229 230.477341c-6.187311 8.507553-19.335347 0.773414-13.92145-8.507552 98.223565-170.151057 157.003021-357.317221 249.039275-529.78852 7.734139-14.694864 29.389728-1.546828 21.655589 12.374622-88.942598 173.244713-145.401813 364.277946-256.773414 525.92145z m80.435045-221.969788c-20.108761 40.990937-40.217523 81.208459-65.740181 119.879154-16.241692 24.749245-54.138973 66.513595-54.138973 97.450151 0 10.054381-13.92145 11.601208-17.015106 2.320242-16.241692-46.404834 61.873112-129.160121 82.755287-169.377644C465.208459 526.694864 517.800604 385.160121 575.806647 246.719033c6.187311-14.694864 30.936556-8.507553 24.749244 6.960725-46.404834 119.879154-94.356495 240.531722-150.042296 356.543807z m-0.773414-135.347432c-48.725076 120.652568-102.864048 239.758308-161.643504 355.770393-5.413897 10.054381-23.202417 3.093656-18.561934-7.734139 53.365559-126.839879 112.145015-251.359517 164.73716-378.97281 36.350453-87.39577 84.302115-177.111782 108.277946-269.148036 3.093656-13.148036 26.296073-10.827795 24.749245 3.093655-5.413897 40.990937-28.616314 78.888218-42.537765 117.558913-22.429003 61.099698-51.045317 119.10574-75.021148 179.432024zM394.054381 506.586103c-30.936556 68.060423-65.740181 134.574018-94.356496 203.407855-18.561934 44.858006-38.670695 88.169184-71.154078 124.519637-7.734139 9.280967-23.202417-3.093656-16.241692-13.148036 33.256798-49.498489 53.365559-104.410876 77.34139-158.549849 25.522659-57.232628 55.685801-112.918429 81.208459-170.924471 54.912387-126.066465 78.888218-266.054381 146.94864-387.480363 4.640483-8.507553 18.561934-2.320242 15.468278 6.187311-47.951662 130.706949-81.981873 269.148036-139.214501 395.987916z m40.217522-235.117825c-22.429003 56.459215-45.63142 112.918429-68.833837 169.377643-54.912387 129.160121-102.864048 267.601208-181.752265 385.160121-6.960725 10.054381-20.882175 1.546828-16.241692-9.280966 59.55287-129.160121 116.785498-259.093656 174.791541-389.027191 34.030211-77.34139 64.966767-156.229607 97.450151-234.344411 17.78852-42.537764 30.936556-91.26284 58.779456-128.386707 7.734139-10.054381 23.975831-1.546828 17.015106 10.054381-34.803625 58.779456-55.685801 133.02719-81.20846 196.44713z m44.858006 592.435045c3.867069-6.960725 6.960725-14.694864 14.694864-17.788519 3.867069-1.546828 8.507553 2.320242 8.507553 6.187311 0 9.280967-8.507553 17.015106-13.92145 23.975831-5.413897 6.960725-10.054381 13.92145-15.468278 20.882175-4.640483 5.413897-11.601208-1.546828-8.507553-6.960725 3.867069-9.280967 10.054381-17.78852 14.694864-26.296073z m46.404834-10.827794c6.187311-8.507553 20.882175 2.320242 14.694864 11.601208-19.335347 27.8429-41.76435 59.55287-67.287009 82.755287-5.413897 4.640483-11.601208-2.320242-7.734139-7.734139 22.429003-27.8429 38.670695-59.55287 60.326284-86.622356z m39.444109 3.093655c7.734139-8.507553 23.975831 3.093656 16.241692 13.148037-23.202417 30.936556-48.725076 58.779456-70.380665 90.489426-5.413897 7.734139-15.468278 0.773414-12.374622-6.960726 15.468278-34.803625 40.990937-69.607251 66.513595-96.676737zM548.73716 920.362538c4.640483-6.960725 7.734139-16.241692 17.015106-17.015106 2.320242 0 5.413897 1.546828 6.960725 3.86707 3.867069 9.280967-2.320242 15.468278-7.734139 22.429003-5.413897 6.960725-10.054381 14.694864-15.468278 20.882175-5.413897 5.413897-16.241692 0-13.148036-7.734139 2.320242-7.734139 7.734139-14.694864 12.374622-22.429003z"
              fill="#1ca538"
              stroke="transparent"
            ></path>
          </svg>
          <div class="title">
            <a>
              <span>永辉超市</span>管理系统
            </a>
          </div>
        </div>
        <div class="loginfrom">
          <el-form
            :model="ruleForm"
            status-icon
            :rules="rules"
            ref="ruleForm"
            class="demo-ruleForm"
          >
            <el-form-item prop="name">
              <el-input
                type="username"
                v-model="ruleForm.name"
                autocomplete="off"
                placeholder="请输入用户名"
              ></el-input>
            </el-form-item>
            <el-form-item prop="pwd">
              <el-input
                type="password"
                v-model="ruleForm.pwd"
                autocomplete="off"
                placeholder="请输入密码"
              ></el-input>
            </el-form-item>
            <el-button type="primary" @click="submitForm('ruleForm')">登录</el-button>
          </el-form>
        </div>
        <div class="loginfooter">
          <!-- 栅格布局 -->
          <el-row>
            <el-col :span="12">
              <el-checkbox v-model="ruleForm.checked" prop="checked">记住我</el-checkbox>
            </el-col>
            <el-col :span="12" class="forgetpwd">忘记密码</el-col>
          </el-row>
        </div>
      </div>
    </div>
    <!-- 右边背景图 -->
    <div class="el-col el-col-14 translate-right">
      <div class="wallpaper"></div>
    </div>
  </div>
</template>
<script>
export default {
  data() {
    // 检测用户名

    var checkUsername = (rule, value, callback) => {
      var reg = /^[a-zA-Z][a-zA-Z0-9]{3,15}$/;
      if (value === "") {
        callback(new Error("请输入用户名"));
      } else if (reg.test(value) === false) {
        callback(new Error("请输入4-15位用户名"));
      }
      callback();
    };

    //检测密码
    var checkPwd = (rule, value, callback) => {
      var reg = /^[a-zA-Z0-9]{3,10}$/;
      if (value === "") {
        callback(new Error("请输入4-10位的密码"));
      } else if (reg.test(value) === false) {
        callback(new Error("请输入4-10位的密码"));
      }
      callback();
    };
    return {
      ruleForm: {
        name: "",
        pwd: "",
        checked: ""
      },
      rules: {
        pwd: [{ validator: checkPwd, trigger: "blur" }],
        name: [{ validator: checkUsername, trigger: "blur" }]
      }
    };
  },
  methods: {
    submitForm(formName) {
      this.$refs[formName].validate(valid => {
        if (valid) {
          // 前端验证通过 发送ajax 把账号 和 密码 发送给后端 验证 用户名和密码是否存在
          // 收集账号和密码（获取用户输入的账号和密码 发送给前端）
          let name = this.ruleForm.name;
          let pwd = this.ruleForm.pwd;
          let parms = { username: name, password: pwd };
          //发送axios请求讲账号密码发给后台 进行查询
          this.req
            .post("/login", parms)
            .then(response => {
              console.log(response);
              let { username, password, msg, usergroup, token } = response;
              //进行比较
              if (name === username && pwd === password) {
                this.$message({
                  type: "success",
                  message: `欢迎回来: ${username}`
                });
                //将登陆用户token 存入local
                window.localStorage.setItem('token',token)
                //同时存入登陆的用户名
                window.localStorage.setItem('username',username)
                // 通过路由跳转 跳转到后端系统首页
                this.$router.push("/");
              } else {
                this.$message.error(msg);
              }
            })
            .catch(err => {
              console.log(err);
            });
        } else {
          console.log("error 验证失败!!");
          return false;
        }
      });
    }
  }
};
</script>

<style lang="less">
html {
  height: 100%;
  width: 100%;
}
body {
  width: 100%;
  height: 100%;
  background-color: #f1f2f7;
}
#app {
  width: 100%;
  height: 100%;
}
.login {
  width: 900px;
  height: 400px;
  background-color: #ffffff;
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  right: 0;
  margin: auto;
  border-radius: 4px;
  .loginfrom {
    .el-button--primary {
      color: #fff;
      background-color: #41b883;
      border-color: #41b883;
      width: 100%;
    }
  }
}

.loginwarper {
  width: 70%;
  margin: 0 auto;
}

.translate-left {
  height: 100%;
}
.translate-right {
  height: 100%;
}
.translate-right .wallpaper {
  width: 100%;
  height: 100%;
  background: url(./loginwallpaper.jpg);
  background-size: cover;
  position: relative;
}
// .el-button--primary {

// }
.logo {
  width: 100%;
  text-align: center;
  padding-top: 25px;
}
.title {
  font-weight: 700;
  padding-top: 8px;
  font-size: 22px;
  padding-bottom: 20px;
}
a span {
  color: #41b883;
}

.el-button {
  margin-top: 10px;
}
.loginfooter {
  margin-top: 20px;
}
.fr {
  float: right;
}
.login .loginwarper .forgetpwd {
  text-align: right;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  color: #606266;
}
.el-checkbox__input.is-checked + .el-checkbox__label {
  color: #41b883;
}
.el-checkbox__input.is-checked .el-checkbox__inner,
.el-checkbox__input.is-indeterminate .el-checkbox__inner {
  background-color: #41b883;
  border-color: #41b883;
}
</style>